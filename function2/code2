Some new code added by dboreham2
